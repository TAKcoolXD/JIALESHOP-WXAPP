{"version":3,"sources":["webpack:///./node_modules/uview-ui/components/u-form/u-form.vue?9abb","webpack:///./node_modules/uview-ui/components/u-form/u-form.vue?712e","webpack:///./node_modules/uview-ui/components/u-form/u-form.vue?1175","webpack:///./node_modules/uview-ui/components/u-form/u-form.vue?96cc","uni-app:///node_modules/uview-ui/components/u-form/u-form.vue"],"names":["_props","_interopRequireDefault","require","_asyncValidator","Schema","warning","_default","exports","default","name","mixins","uni","$u","mpMixin","mixin","props","provide","uForm","data","formRules","validator","originalModel","watch","rules","immediate","handler","n","setRules","propsChange","_this$children","children","length","map","child","updateParentData","model","deepClone","computed","errorType","borderBottom","labelPosition","labelWidth","labelAlign","labelStyle","created","methods","Object","keys","process","error","resetFields","resetModel","obj","_this","prop","value","getProperty","setProperty","clearValidate","concat","undefined","includes","message","validateField","callback","_arguments","arguments","_this2","_asyncToGenerator2","_regenerator","mark","_callee","event","wrap","_callee$","_context","prev","next","$nextTick","errorsRes","childErrors","propertyVal","propertyChain","split","propertyName","rule","i","ruleItem","trigger","_defineProperty2","validate","errors","fields","_childErrors$0$messag","_childErrors$","test","array","push","apply","_toConsumableArray2","stop","_this3","Promise","resolve","reject","formItemProps","item","toast"],"mappings":"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","file":"node-modules/uview-ui/components/u-form/u-form.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./u-form.vue?vue&type=template&id=ed64ceb2&scoped=true&\"\nvar renderjs\nimport script from \"./u-form.vue?vue&type=script&lang=js&\"\nexport * from \"./u-form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"ed64ceb2\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"node_modules/uview-ui/components/u-form/u-form.vue\"\nexport default component.exports","export * from \"-!../../../@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../@dcloudio/webpack-uni-mp-loader/lib/style.js!./u-form.vue?vue&type=template&id=ed64ceb2&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../babel-loader/lib/index.js!../../../@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../@dcloudio/webpack-uni-mp-loader/lib/style.js!./u-form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../babel-loader/lib/index.js!../../../@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../@dcloudio/webpack-uni-mp-loader/lib/style.js!./u-form.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"u-form\">\r\n\t\t<slot />\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport props from \"./props.js\";\r\n\timport Schema from \"../../libs/util/async-validator\";\r\n\t// 去除警告信息\r\n\tSchema.warning = function() {};\r\n\t/**\r\n\t * Form 表单\r\n\t * @description 此组件一般用于表单场景，可以配置Input输入框，Select弹出框，进行表单验证等。\r\n\t * @tutorial https://www.uviewui.com/components/form.html\r\n\t * @property {Object}\t\t\t\t\t\tmodel\t\t\t当前form的需要验证字段的集合\r\n\t * @property {Object | Function | Array}\trules\t\t\t验证规则\r\n\t * @property {String}\t\t\t\t\t\terrorType\t\t错误的提示方式，见上方说明 ( 默认 message )\r\n\t * @property {Boolean}\t\t\t\t\t\tborderBottom\t是否显示表单域的下划线边框   ( 默认 true ）\r\n\t * @property {String}\t\t\t\t\t\tlabelPosition\t表单域提示文字的位置，left-左侧，top-上方 ( 默认 'left' ）\r\n\t * @property {String | Number}\t\t\t\tlabelWidth\t\t提示文字的宽度，单位px  ( 默认 45 ）\r\n\t * @property {String}\t\t\t\t\t\tlabelAlign\t\tlable字体的对齐方式   ( 默认 ‘left' ）\r\n\t * @property {Object}\t\t\t\t\t\tlabelStyle\t\tlable的样式，对象形式\r\n\t * @example <u--formlabelPosition=\"left\" :model=\"model1\" :rules=\"rules\" ref=\"form1\"></u--form>\r\n\t */\r\n\texport default {\r\n\t\tname: \"u-form\",\r\n\t\tmixins: [uni.$u.mpMixin, uni.$u.mixin, props],\r\n\t\tprovide() {\r\n\t\t\treturn {\r\n\t\t\t\tuForm: this,\r\n\t\t\t};\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tformRules: {},\r\n\t\t\t\t// 规则校验器\r\n\t\t\t\tvalidator: {},\r\n\t\t\t\t// 原始的model快照，用于resetFields方法重置表单时使用\r\n\t\t\t\toriginalModel: null,\r\n\t\t\t};\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\t// 监听规则的变化\r\n\t\t\trules: {\r\n\t\t\t\timmediate: true,\r\n\t\t\t\thandler(n) {\r\n\t\t\t\t\tthis.setRules(n);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\t// 监听属性的变化，通知子组件u-form-item重新获取信息\r\n\t\t\tpropsChange(n) {\r\n\t\t\t\tif (this.children?.length) {\r\n\t\t\t\t\tthis.children.map((child) => {\r\n\t\t\t\t\t\t// 判断子组件(u-form-item)如果有updateParentData方法的话，就就执行(执行的结果是子组件重新从父组件拉取了最新的值)\r\n\t\t\t\t\t\ttypeof child.updateParentData == \"function\" &&\r\n\t\t\t\t\t\t\tchild.updateParentData();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 监听model的初始值作为重置表单的快照\r\n\t\t\tmodel: {\r\n\t\t\t\timmediate: true,\r\n\t\t\t\thandler(n) {\r\n\t\t\t\t\tif (!this.originalModel) {\r\n\t\t\t\t\t\tthis.originalModel = uni.$u.deepClone(n);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tpropsChange() {\r\n\t\t\t\treturn [\r\n\t\t\t\t\tthis.errorType,\r\n\t\t\t\t\tthis.borderBottom,\r\n\t\t\t\t\tthis.labelPosition,\r\n\t\t\t\t\tthis.labelWidth,\r\n\t\t\t\t\tthis.labelAlign,\r\n\t\t\t\t\tthis.labelStyle,\r\n\t\t\t\t];\r\n\t\t\t},\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// 存储当前form下的所有u-form-item的实例\r\n\t\t\t// 不能定义在data中，否则微信小程序会造成循环引用而报错\r\n\t\t\tthis.children = [];\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 手动设置校验的规则，如果规则中有函数的话，微信小程序中会过滤掉，所以只能手动调用设置规则\r\n\t\t\tsetRules(rules) {\r\n\t\t\t\t// 判断是否有规则\r\n\t\t\t\tif (Object.keys(rules).length === 0) return;\n\t\t\t\tif (process.env.NODE_ENV === 'development' && Object.keys(this.model).length === 0) {\n\t\t\t\t\tuni.$u.error('设置rules，model必须设置！如果已经设置，请刷新页面。');\n\t\t\t\t\treturn;\n\t\t\t\t};\r\n\t\t\t\tthis.formRules = rules;\r\n\t\t\t\t// 重新将规则赋予Validator\r\n\t\t\t\tthis.validator = new Schema(rules);\r\n\t\t\t},\r\n\t\t\t// 清空所有u-form-item组件的内容，本质上是调用了u-form-item组件中的resetField()方法\r\n\t\t\tresetFields() {\r\n\t\t\t\tthis.resetModel();\r\n\t\t\t},\r\n\t\t\t// 重置model为初始值的快照\r\n\t\t\tresetModel(obj) {\r\n\t\t\t\t// 历遍所有u-form-item，根据其prop属性，还原model的原始快照\r\n\t\t\t\tthis.children.map((child) => {\r\n\t\t\t\t\tconst prop = child?.prop;\r\n\t\t\t\t\tconst value = uni.$u.getProperty(this.originalModel, prop);\r\n\t\t\t\t\tuni.$u.setProperty(this.model, prop, value);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 清空校验结果\r\n\t\t\tclearValidate(props) {\r\n\t\t\t\tprops = [].concat(props);\r\n\t\t\t\tthis.children.map((child) => {\r\n\t\t\t\t\t// 如果u-form-item的prop在props数组中，则清除对应的校验结果信息\r\n\t\t\t\t\tif (props[0] === undefined || props.includes(child.prop)) {\r\n\t\t\t\t\t\tchild.message = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 对部分表单字段进行校验\r\n\t\t\tasync validateField(value, callback, event = null) {\r\n\t\t\t\t// $nextTick是必须的，否则model的变更，可能会延后于此方法的执行\r\n\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t// 校验错误信息，返回给回调方法，用于存放所有form-item的错误信息\r\n\t\t\t\t\tconst errorsRes = [];\r\n\t\t\t\t\t// 如果为字符串，转为数组\r\n\t\t\t\t\tvalue = [].concat(value);\r\n\t\t\t\t\t// 历遍children所有子form-item\r\n\t\t\t\t\tthis.children.map((child) => {\r\n\t\t\t\t\t\t// 用于存放form-item的错误信息\r\n\t\t\t\t\t\tconst childErrors = [];\r\n\t\t\t\t\t\tif (value.includes(child.prop)) {\r\n\t\t\t\t\t\t\t// 获取对应的属性，通过类似'a.b.c'的形式\r\n\t\t\t\t\t\t\tconst propertyVal = uni.$u.getProperty(\r\n\t\t\t\t\t\t\t\tthis.model,\r\n\t\t\t\t\t\t\t\tchild.prop\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t// 属性链数组\r\n\t\t\t\t\t\t\tconst propertyChain = child.prop.split(\".\");\r\n\t\t\t\t\t\t\tconst propertyName =\r\n\t\t\t\t\t\t\t\tpropertyChain[propertyChain.length - 1];\r\n\r\n\t\t\t\t\t\t\tconst rule = this.formRules[child.prop];\r\n\t\t\t\t\t\t\t// 如果不存在对应的规则，直接返回，否则校验器会报错\r\n\t\t\t\t\t\t\tif (!rule) return;\r\n\t\t\t\t\t\t\t// rule规则可为数组形式，也可为对象形式，此处拼接成为数组\r\n\t\t\t\t\t\t\tconst rules = [].concat(rule);\r\n\r\n\t\t\t\t\t\t\t// 对rules数组进行校验\r\n\t\t\t\t\t\t\tfor (let i = 0; i < rules.length; i++) {\r\n\t\t\t\t\t\t\t\tconst ruleItem = rules[i];\r\n\t\t\t\t\t\t\t\t// 将u-form-item的触发器转为数组形式\r\n\t\t\t\t\t\t\t\tconst trigger = [].concat(ruleItem?.trigger);\r\n\t\t\t\t\t\t\t\t// 如果是有传入触发事件，但是此form-item却没有配置此触发器的话，不执行校验操作\r\n\t\t\t\t\t\t\t\tif (event && !trigger.includes(event)) continue;\r\n\t\t\t\t\t\t\t\t// 实例化校验对象，传入构造规则\r\n\t\t\t\t\t\t\t\tconst validator = new Schema({\r\n\t\t\t\t\t\t\t\t\t[propertyName]: ruleItem,\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tvalidator.validate({\r\n\t\t\t\t\t\t\t\t\t\t[propertyName]: propertyVal,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t(errors, fields) => {\r\n\t\t\t\t\t\t\t\t\t\tif (uni.$u.test.array(errors)) {\r\n\t\t\t\t\t\t\t\t\t\t\terrorsRes.push(...errors);\r\n\t\t\t\t\t\t\t\t\t\t\tchildErrors.push(...errors);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tchild.message =\r\n\t\t\t\t\t\t\t\t\t\t\tchildErrors[0]?.message ?? null;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// 执行回调函数\r\n\t\t\t\t\ttypeof callback === \"function\" && callback(errorsRes);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 校验全部数据\r\n\t\t\tvalidate(callback) {\n\t\t\t\t// 开发环境才提示，生产环境不会提示\n\t\t\t\tif (process.env.NODE_ENV === 'development' && Object.keys(this.formRules).length === 0) {\n\t\t\t\t\tuni.$u.error('未设置rules，请看文档说明！如果已经设置，请刷新页面。');\n\t\t\t\t\treturn;\n\t\t\t\t}\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\t// $nextTick是必须的，否则model的变更，可能会延后于validate方法\r\n\t\t\t\t\tthis.$nextTick(() => {\r\n\t\t\t\t\t\t// 获取所有form-item的prop，交给validateField方法进行校验\r\n\t\t\t\t\t\tconst formItemProps = this.children.map(\r\n\t\t\t\t\t\t\t(item) => item.prop\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.validateField(formItemProps, (errors) => {\r\n\t\t\t\t\t\t\tif(errors.length) {\r\n\t\t\t\t\t\t\t\t// 如果错误提示方式为toast，则进行提示\r\n\t\t\t\t\t\t\t\tthis.errorType === 'toast' && uni.$u.toast(errors[0].message)\r\n\t\t\t\t\t\t\t\treject(errors)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tresolve(true)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n"],"sourceRoot":""}